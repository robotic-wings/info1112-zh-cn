# INFO1112 Shell Practice Solutions

**1. 编写shell脚本，打印一个当前正在运行的进程的列表，一行一个，使得占用CPU时间越多的进程越靠上**

`ps | (sed -u 1q; sort -r -k3,3)`

代码解析：
- ps 代表打印正在运行的进程的列表
- 竖杠是管道符号，把ps指令的输出流交给管道符号右边的指令
- "sed -u 1q"代表截取输出流的第一行（1q）；-u使得剩下的输出流数据能够留给 sort 指令
- linux中的sort命令对数字默认是升序排列，也就是从小到大排列。题目要求CPU时间越高的进程越靠上，那么就是降序（从大到小）进行排列。"-kN,N"表示按照表格的第N列的数据来进行排列。

**2. #! 的作用**
#! 在脚本文件的首部，可以用来指定用来执行脚本的解释器。

**3. 常用shell环境变量（注意大写）**
1) HOME变量是自己（当前登录的用户）的用户目录路径
2) CDPATH变量的作用：
如果有一个目录/a/b/c，这个目录下有子文件夹dir1,dir2,dir3……要是这个目录下的dir1,dir2,...经常需要被访问的话，如果不处于这个目录，每次都要前面输入/a/b/c那就太麻烦了。可以把目录/a/b/c加入CDPATH：
`export CDPATH=/a/b/c`
这样的话，比如要在任意的工作目录访问dir1，就直接
`cd dir1`而不用`cd /a/b/c/dir1`了。
3) PWD变量：
pwd 的意思是**P**ath of the **W**orking **D**irectory
执行这个命令：
`echo $PWD`
就可以显示当前所在的工作目录。

**4. 制作一个命令，接受一个字符串参数，将这个字符串写到文件$HOME/.info的末尾，字符串前要有一个时间戳。**
先创建一个bash脚本，写下如下代码
`
#!/bin/bash
date>>$HOME/.info
echo $@>>$HOME/.info
`
代码解析：
- \>\>是追加符号，>是覆盖符号。追加就是把新的内容写在文件末尾，而覆盖就会使得文件里原来的内容消失。
- date指令可以输出日期和时间
- $@代表接受全部的命令行参数

bash脚本取名为addinfo.sh，调用：
`sudo bash ./addinfo.sh hello world`

**5. 制作一个命令，接受一个正则表达式参数，打印$HOME/.info文件当中所有与该正则表达式相匹配的行。**

创建一个bash文件match.sh，输入如下代码：
`grep $1 $HOME/.info`

在调用grep的时候，如果正则表达式需要带空格，可以用\\s，不要直接打空格上去——解释器会把空格后的字符当作是下一个参数。正则表达式中\s表示空格，打2个反斜杠是因为反斜杠也是bash的关键字符，需要进行转义

